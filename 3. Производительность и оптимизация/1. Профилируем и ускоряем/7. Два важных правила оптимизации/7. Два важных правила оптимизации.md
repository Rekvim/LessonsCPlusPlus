## Два важных правила оптимизации
В предыдущем уроке нас постигла неудача: оптимизация не дала желаемого ускорения. Это показывает, что оптимизация — не всегда хорошо. Код стало сложнее писать и читать, а результат оказался неудовлетворительным. Чтобы избегать подобных неприятностей, следуйте первому правилу оптимизации.

    Первое правило оптимизации: избегайте преждевременной оптимизации.

Главные достоинства вашей программы — это надёжность, понятность и скорость. Усложняя программу ради скорости, вы ухудшаете понятность, а скорее всего, и надёжность, потому что в сложных и непонятных программах гораздо проще допустить ошибку. Особенно обидно, если результат того не стоил.

Если оптимизация сработала, и вы путём большого труда ускорили функцию, занимавшую 10 миллисекунд, до одной миллисекунды — это хорошее достижение. Но если вся программа при этом работает 10 секунд, ускорение попросту не будет заметно. Понять, где именно нужна оптимизация, поможет профилировка. Это второе правило оптимизации.

    Второе правило оптимизации: измеряйте.

Только измерения помогут выявить узкие места программы — те, где ваша программа в действительности проводит больше всего времени. Их расположение часто противоречит интуиции.

Есть даже эмпирическое правило Парето, согласно которому:
    
    
    80% всего времени выполнения программы тратится на 20% кода.

В реальных программах это соотношение может быть иным и часто даже более разительным. Но в любом случае оно говорит, что во время разработки стоит думать не только об эффективности кода, но и о том, что ему может понадобиться оптимизация.