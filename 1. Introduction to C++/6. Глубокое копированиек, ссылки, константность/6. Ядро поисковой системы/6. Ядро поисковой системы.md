## Ядро поисковой системы
В этом уроке вы напишете центральную часть поискового сервера. Ваш сервер научится сохранять документы и искать их.
Поиск будет возвращать id документов, которые содержат хотя бы одно из слов поискового запроса. Рассмотрим работу поиска на следующем списке документов:
Список документов
|id|	Текст|
|:-:|:-:|
|0	|Москва Патриаршие пруды найден белый пушистый кот с зелёными глазами|
|1	|Москва Лужники найден серый пёс особые приметы грустные глаза и длинные уши|
|2	|Москва Новослободская обнаружен жёлтый волнистый попугай с пёстрыми перьями|
|3	|Москва Лубянка найден пушистый пёс с красивым ошейником|

По запросу «пушистый кот» будут найдены документы с id 0 и 3, так как они содержат слова «кот» и «пушистый».

Хорошая поисковая система учитывает стоп-слова. Это союзы и предлоги, которые встречаются во многих документах и обычно не несут смысловой нагрузки. Если их исключить из обработки, результаты поиска станут более точными.

Например, если к стоп-словам отнести «и», «в», «на», «с», по запросу «кот с пятном на ухе» будет найден только документ 0, содержащий слово «кот». Остальные документы пересекаются с поисковым запросом только в стоп-словах, поэтому эти документы не будут приниматься во внимание.

С хранением стоп-слов разобрались. Теперь займёмся хранением базы документов. В простейшем случае можно использовать `vector<string>`, в котором каждая строка — текст соответствующего документа. Но так неудобно обрабатывать документ по словам во время поиска: пришлось бы всякий раз разбивать документ на слова.

Так как каждый документ добавляется в базу один раз, а в поиске слов участвует многократно, будем хранить документы разделёнными на отдельные слова. Отдельный документ будет представлен контейнером `vector<string>`, а база данных — `vector<vector<string>>`.

На этапе построения базы данных есть смысл хранить документы, исключив из них стоп-слова. Так и память сэкономится, и поиск будет быстрее. На рисунке показаны четыре документа в виде `vector<vector<string>>`. Стоп-слова «с» и «на», которые были в оригинальных документах, в базе данных сервера не содержатся.

![alt text](image.png)

Так будет выглядеть добавление документа в базу данных сервера:

```cpp
// Создадим базу данных, в которой будем хранить документы
// Каждый документ - вектор слов документа
vector<vector<string>> documents;
// Переменная document - это тот документ, который нужно добавить в базу данных
string document = "a strange brown creature was seen in the box of oranges"s;
// Подготовим множество стоп-слов
const set<string> stop_words = {"a"s, "the"s, "on"s, "end"s};

AddDocument(documents, stop_words, document);
```
Внутри функции `AddDocument`: 

- документ будет разбит на слова;
- стоп-слова будут исключены из рассмотрения;
- оставшиеся слова будут добавлены в базу данных, которую функция `AddDocument` принимает по ссылке.

Вот так будет выглядеть код добавления документов. Он включает вспомогательную функцию `SplitIntoWordsNoStop`, которая убирает стоп-слова. В нём также использована знакомая функция `SplitIntoWords`.

```cpp
vector<string> SplitIntoWordsNoStop(const string& text, const set<string>& stop_words) {
    vector<string> words;
    // проходим по всем словам из текста и проверяем, что их нет в списке стоп-слов
    for (const string& word : SplitIntoWords(text)) {
        if (stop_words.count(word) == 0) {
            words.push_back(word);
        }
    }
    // вернём результат без стоп-слов
    return words;
}

void AddDocument(vector<vector<string>>& documents, const set<string>& stop_words,
                 const string& document) {
    const vector<string> words = SplitIntoWordsNoStop(document, stop_words);
    documents.push_back(words);
}
```

Сервер умеет сохранять документы. Теперь осталось научить его искать.